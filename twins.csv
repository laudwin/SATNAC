import pandas as pd
import json

# Load the CSV file
df = pd.read_csv('twins.csv')

# Convert to JSON
twins_list = []
for index, row in df.iterrows():
    twin = {
        "$dtId": row["$dtId"],
        "$metadata": {
            "$model": row["$model"]
        },
        "machineId": row["machineId"],
        "heatTreatmentProcess": row["heatTreatmentProcess"]
    }
    twins_list.append(twin)

# Create the final JSON structure
digital_twin_graph = {
    "@context": "dtmi:dtdl:context;2",
    "digitalTwins": twins_list,
    "relationships": []  # Add relationships if any
}

# Save to a JSON file
with open('digital_twin_graph.json', 'w') as json_file:
    json.dump(digital_twin_graph, json_file, indent=4)

print("JSON file created successfully!")
